#pragma once
#include <GL/glut.h>
#include "grid.h"
#include <stdlib.h>
#include <vector>
#include <utility>

using namespace std;

class Surface{
    public:
    Surface();
    ~Surface();
    void load_dimensions(int x,int y, int z);
    void load_surface_data(char *file);
    unsigned char get_index(double *vertValues);
    void marching_cube();
    void generate_triangles(Cube cube);


    Point interpolate(Point p1, Point p2,double v1, double v2);
    std::pair<int,int> edgeToVertex(int edgeList);

    void render_surface();    

    double*** points;

    int width,height,depth;
    std::vector<Triangle> triangles;
    private:

    int edgeTable[256] = {
        0, 265, 515, 778, 1030, 1295, 1541, 1804, 2060, 2309, 2575, 2822, 3082, 3331, 3593, 3840, 400, 
        153, 915, 666, 1430, 1183, 1941, 1692, 2460, 2197, 2975, 2710, 3482, 3219, 3993, 3728, 560, 
        825, 51, 314, 1590, 1855, 1077, 1340, 2620, 2869, 2111, 2358, 3642, 3891, 3129, 3376, 928, 
        681, 419, 170, 1958, 1711, 1445, 1196, 2988, 2725, 2479, 2214, 4010, 3747, 3497, 3232, 1120, 
        1385, 1635, 1898, 102, 367, 613, 876, 3180, 3429, 3695, 3942, 2154, 2403, 2665, 2912, 1520, 
        1273, 2035, 1786, 502, 255, 1013, 764, 3580, 3317, 4095, 3830, 2554, 2291, 3065, 2800, 1616, 
        1881, 1107, 1370, 598, 863, 85, 348, 3676, 3925, 3167, 3414, 2650, 2899, 2137, 2384, 1984, 
        1737, 1475, 1226, 966, 719, 453, 204, 4044, 3781, 3535, 3270, 3018, 2755, 2505, 2240, 2240, 
        2505, 2755, 3018, 3270, 3535, 3781, 4044, 204, 453, 719, 966, 1226, 1475, 1737, 1984, 2384, 
        2137, 2899, 2650, 3414, 3167, 3925, 3676, 348, 85, 863, 598, 1370, 1107, 1881, 1616, 2800, 
        3065, 2291, 2554, 3830, 4095, 3317, 3580, 764, 1013, 255, 502, 1786, 2035, 1273, 1520, 2912, 
        2665, 2403, 2154, 3942, 3695, 3429, 3180, 876, 613, 367, 102, 1898, 1635, 1385, 1120, 3232, 
        3497, 3747, 4010, 2214, 2479, 2725, 2988, 1196, 1445, 1711, 1958, 170, 419, 681, 928, 3376, 
        3129, 3891, 3642, 2358, 2111, 2869, 2620, 1340, 1077, 1855, 1590, 314, 51, 825, 560, 3728, 
        3993, 3219, 3482, 2710, 2975, 2197, 2460, 1692, 1941, 1183, 1430, 666, 915, 153, 400, 3840, 
        3593, 3331, 3082, 2822, 2575, 2309, 2060, 1804, 1541, 1295, 1030, 778, 515, 265, 0 };

std::vector<std::vector<int> > triangleTable = {
/*0*/ {},
/*1*/ {0, 3, 8, },
/*2*/ {9, 1, 0, },
/*3*/ {1, 3, 9, 3, 8, 9, },
/*4*/ {2, 1, 10, },
/*5*/ {1, 10, 2, 3, 8, 0, },
/*6*/ {2, 0, 10, 0, 9, 10, },
/*7*/ {3, 2, 8, 2, 8, 10, 8, 9, 10, },
/*8*/ {3, 2, 11, },
/*9*/ {0, 2, 8, 2, 11, 8, },
/*10*/ {0, 9, 1, 2, 11, 3, },
/*11*/ {2, 1, 11, 1, 11, 9, 11, 8, 9, },
/*12*/ {3, 1, 11, 1, 10, 11, },
/*13*/ {1, 0, 10, 0, 10, 8, 10, 11, 8, },
/*14*/ {0, 3, 9, 3, 9, 11, 9, 10, 11, },
/*15*/ {8, 9, 10, 8, 10, 11, },
/*16*/ {8, 7, 4, },
/*17*/ {3, 7, 0, 7, 4, 0, },
/*18*/ {8, 7, 4, 9, 1, 0, },
/*19*/ {9, 4, 1, 4, 1, 7, 1, 3, 7, },
/*20*/ {8, 7, 4, 1, 10, 2, },
/*21*/ {3, 7, 0, 7, 4, 0, 1, 10, 2, },
/*22*/ {9, 10, 0, 10, 2, 0, 8, 7, 4, },
/*23*/ {4, 7, 3, 4, 3, 10, 4, 9, 10, 2, 3, 10, },
/*24*/ {3, 2, 11, 7, 4, 8, },
/*25*/ {7, 11, 4, 11, 4, 2, 4, 0, 2, },
/*26*/ {4, 7, 8, 0, 1, 9, 3, 2, 11, },
/*27*/ {4, 7, 11, 4, 2, 11, 4, 2, 9, 2, 1, 9, },
/*28*/ {3, 1, 11, 1, 10, 11, 7, 4, 8, },
/*29*/ {7, 4, 0, 7, 0, 10, 7, 11, 10, 1, 0, 10, },
/*30*/ {0, 3, 9, 3, 9, 11, 4, 7, 8, 9, 10, 11, },
/*31*/ {7, 4, 11, 4, 11, 9, 11, 10, 9, },
/*32*/ {4, 5, 9, },
/*33*/ {0, 3, 8, 4, 5, 9, },
/*34*/ {5, 1, 4, 1, 0, 4, },
/*35*/ {4, 8, 5, 8, 5, 3, 5, 1, 3, },
/*36*/ {9, 4, 5, 10, 2, 1, },
/*37*/ {8, 3, 0, 9, 5, 4, 1, 10, 2, },
/*38*/ {10, 5, 2, 5, 2, 4, 2, 0, 4, },
/*39*/ {8, 3, 2, 8, 10, 2, 8, 10, 4, 10, 5, 4, },
/*40*/ {4, 5, 9, 3, 2, 11, },
/*41*/ {0, 2, 8, 2, 11, 8, 4, 5, 9, },
/*42*/ {0, 4, 1, 4, 5, 1, 2, 11, 3, },
/*43*/ {4, 5, 1, 4, 1, 11, 4, 8, 11, 2, 1, 11, },
/*44*/ {10, 11, 1, 11, 3, 1, 9, 4, 5, },
/*45*/ {4, 5, 8, 5, 8, 10, 0, 1, 9, 8, 11, 10, },
/*46*/ {3, 0, 4, 3, 4, 10, 3, 11, 10, 5, 4, 10, },
/*47*/ {4, 5, 8, 5, 8, 10, 8, 11, 10, },
/*48*/ {7, 5, 8, 5, 9, 8, },
/*49*/ {0, 9, 3, 9, 3, 5, 3, 7, 5, },
/*50*/ {8, 0, 7, 0, 7, 1, 7, 5, 1, },
/*51*/ {7, 3, 1, 7, 1, 5, },
/*52*/ {9, 8, 5, 8, 7, 5, 10, 2, 1, },
/*53*/ {10, 2, 5, 2, 5, 3, 9, 0, 1, 5, 7, 3, },
/*54*/ {8, 7, 5, 8, 5, 2, 8, 0, 2, 10, 5, 2, },
/*55*/ {10, 2, 5, 2, 5, 3, 5, 7, 3, },
/*56*/ {7, 5, 8, 5, 9, 8, 3, 2, 11, },
/*57*/ {9, 5, 7, 9, 7, 2, 9, 0, 2, 11, 7, 2, },
/*58*/ {8, 0, 7, 0, 7, 1, 11, 2, 3, 7, 5, 1, },
/*59*/ {2, 11, 1, 11, 1, 7, 1, 5, 7, },
/*60*/ {8, 7, 9, 7, 9, 5, 3, 11, 1, 11, 1, 10, },
/*61*/ {5, 7, 10, 7, 11, 10, 1, 0, 9, },
/*62*/ {11, 10, 7, 10, 5, 7, 8, 0, 3, },
/*63*/ {5, 7, 10, 7, 11, 10, },
/*64*/ {10, 5, 6, },
/*65*/ {0, 3, 8, 5, 6, 10, },
/*66*/ {1, 0, 9, 5, 6, 10, },
/*67*/ {1, 3, 9, 3, 8, 9, 5, 6, 10, },
/*68*/ {1, 5, 2, 5, 6, 2, },
/*69*/ {1, 5, 2, 5, 6, 2, 3, 8, 0, },
/*70*/ {5, 9, 6, 9, 6, 0, 6, 2, 0, },
/*71*/ {3, 2, 6, 3, 6, 9, 3, 8, 9, 5, 6, 9, },
/*72*/ {10, 5, 6, 11, 3, 2, },
/*73*/ {11, 8, 2, 8, 0, 2, 10, 5, 6, },
/*74*/ {6, 5, 10, 2, 3, 11, 1, 0, 9, },
/*75*/ {2, 1, 11, 1, 11, 9, 6, 5, 10, 11, 8, 9, },
/*76*/ {11, 6, 3, 6, 3, 5, 3, 1, 5, },
/*77*/ {0, 1, 5, 0, 5, 11, 0, 8, 11, 6, 5, 11, },
/*78*/ {9, 5, 6, 9, 11, 6, 9, 11, 0, 11, 3, 0, },
/*79*/ {5, 6, 9, 6, 9, 11, 9, 8, 11, },
/*80*/ {4, 8, 7, 6, 10, 5, },
/*81*/ {4, 0, 7, 0, 3, 7, 6, 10, 5, },
/*82*/ {0, 1, 9, 4, 7, 8, 5, 6, 10, },
/*83*/ {9, 4, 1, 4, 1, 7, 10, 6, 5, 1, 3, 7, },
/*84*/ {6, 2, 5, 2, 1, 5, 4, 8, 7, },
/*85*/ {0, 3, 4, 3, 4, 7, 1, 2, 5, 2, 5, 6, },
/*86*/ {8, 7, 0, 7, 0, 6, 9, 5, 4, 0, 2, 6, },
/*87*/ {7, 3, 6, 3, 2, 6, 5, 9, 4, },
/*88*/ {8, 4, 7, 11, 2, 3, 6, 10, 5, },
/*89*/ {10, 5, 2, 5, 2, 4, 11, 7, 6, 2, 0, 4, },
/*90*/ {0, 3, 8, 1, 2, 10, 4, 5, 9, 6, 7, 11, },
/*91*/ {11, 7, 6, 10, 1, 2, 5, 9, 4, },
/*92*/ {11, 6, 3, 6, 3, 5, 8, 4, 7, 3, 1, 5, },
/*93*/ {5, 1, 4, 1, 0, 4, 7, 11, 6, },
/*94*/ {9, 5, 4, 8, 3, 0, 7, 11, 6, },
/*95*/ {7, 11, 6, 5, 9, 4, },
/*96*/ {4, 6, 9, 6, 10, 9, },
/*97*/ {4, 6, 9, 6, 10, 9, 0, 3, 8, },
/*98*/ {1, 10, 0, 10, 0, 6, 0, 4, 6, },
/*99*/ {8, 3, 1, 8, 1, 6, 8, 4, 6, 10, 1, 6, },
/*100*/ {9, 1, 4, 1, 4, 2, 4, 6, 2, },
/*101*/ {9, 1, 4, 1, 4, 2, 8, 3, 0, 4, 6, 2, },
/*102*/ {4, 0, 2, 4, 2, 6, },
/*103*/ {3, 8, 2, 8, 2, 4, 2, 6, 4, },
/*104*/ {10, 9, 6, 9, 4, 6, 11, 3, 2, },
/*105*/ {11, 6, 8, 6, 8, 4, 2, 10, 0, 10, 0, 9, },
/*106*/ {11, 3, 6, 3, 6, 0, 10, 1, 2, 6, 4, 0, },
/*107*/ {6, 4, 11, 4, 8, 11, 2, 1, 10, },
/*108*/ {9, 1, 3, 9, 3, 6, 9, 4, 6, 11, 3, 6, },
/*109*/ {8, 11, 4, 11, 6, 4, 9, 1, 0, },
/*110*/ {11, 3, 6, 3, 6, 0, 6, 4, 0, },
/*111*/ {6, 4, 11, 4, 8, 11, },
/*112*/ {6, 7, 10, 7, 10, 8, 10, 9, 8, },
/*113*/ {0, 3, 7, 0, 7, 10, 0, 9, 10, 6, 7, 10, },
/*114*/ {0, 1, 10, 0, 6, 10, 0, 6, 8, 6, 7, 8, },
/*115*/ {6, 10, 7, 10, 7, 1, 7, 3, 1, },
/*116*/ {7, 6, 2, 7, 2, 9, 7, 8, 9, 1, 2, 9, },
/*117*/ {2, 6, 3, 6, 7, 3, 0, 9, 1, },
/*118*/ {8, 7, 0, 7, 0, 6, 0, 2, 6, },
/*119*/ {2, 6, 3, 6, 7, 3, },
/*120*/ {3, 2, 8, 2, 8, 10, 7, 6, 11, 8, 9, 10, },
/*121*/ {2, 0, 10, 0, 9, 10, 6, 7, 11, },
/*122*/ {7, 6, 11, 3, 0, 8, 2, 1, 10, },
/*123*/ {2, 1, 10, 6, 7, 11, },
/*124*/ {8, 9, 3, 9, 1, 3, 11, 6, 7, },
/*125*/ {9, 1, 0, 7, 11, 6, },
/*126*/ {11, 6, 7, 8, 0, 3, },
/*127*/ {11, 6, 7, },
/*128*/ {11, 6, 7, },
/*129*/ {11, 6, 7, 8, 0, 3, },
/*130*/ {9, 1, 0, 7, 11, 6, },
/*131*/ {8, 9, 3, 9, 1, 3, 11, 6, 7, },
/*132*/ {2, 1, 10, 6, 7, 11, },
/*133*/ {7, 6, 11, 3, 0, 8, 2, 1, 10, },
/*134*/ {2, 0, 10, 0, 9, 10, 6, 7, 11, },
/*135*/ {3, 2, 8, 2, 8, 10, 7, 6, 11, 8, 9, 10, },
/*136*/ {2, 6, 3, 6, 7, 3, },
/*137*/ {8, 7, 0, 7, 0, 6, 0, 2, 6, },
/*138*/ {2, 6, 3, 6, 7, 3, 0, 9, 1, },
/*139*/ {7, 6, 2, 7, 2, 9, 7, 8, 9, 1, 2, 9, },
/*140*/ {6, 10, 7, 10, 7, 1, 7, 3, 1, },
/*141*/ {0, 1, 10, 0, 6, 10, 0, 6, 8, 6, 7, 8, },
/*142*/ {0, 3, 7, 0, 7, 10, 0, 9, 10, 6, 7, 10, },
/*143*/ {6, 7, 10, 7, 10, 8, 10, 9, 8, },
/*144*/ {6, 4, 11, 4, 8, 11, },
/*145*/ {11, 3, 6, 3, 6, 0, 6, 4, 0, },
/*146*/ {8, 11, 4, 11, 6, 4, 9, 1, 0, },
/*147*/ {9, 1, 3, 9, 3, 6, 9, 4, 6, 11, 3, 6, },
/*148*/ {6, 4, 11, 4, 8, 11, 2, 1, 10, },
/*149*/ {11, 3, 6, 3, 6, 0, 10, 1, 2, 6, 4, 0, },
/*150*/ {11, 6, 8, 6, 8, 4, 2, 10, 0, 10, 0, 9, },
/*151*/ {10, 9, 6, 9, 4, 6, 11, 3, 2, },
/*152*/ {3, 8, 2, 8, 2, 4, 2, 6, 4, },
/*153*/ {4, 0, 2, 4, 2, 6, },
/*154*/ {9, 1, 4, 1, 4, 2, 8, 3, 0, 4, 6, 2, },
/*155*/ {9, 1, 4, 1, 4, 2, 4, 6, 2, },
/*156*/ {8, 3, 1, 8, 1, 6, 8, 4, 6, 10, 1, 6, },
/*157*/ {1, 10, 0, 10, 0, 6, 0, 4, 6, },
/*158*/ {4, 6, 9, 6, 10, 9, 0, 3, 8, },
/*159*/ {4, 6, 9, 6, 10, 9, },
/*160*/ {7, 11, 6, 5, 9, 4, },
/*161*/ {9, 5, 4, 8, 3, 0, 7, 11, 6, },
/*162*/ {5, 1, 4, 1, 0, 4, 7, 11, 6, },
/*163*/ {11, 6, 3, 6, 3, 5, 8, 4, 7, 3, 1, 5, },
/*164*/ {11, 7, 6, 10, 1, 2, 5, 9, 4, },
/*165*/ {0, 3, 8, 1, 2, 10, 4, 5, 9, 6, 7, 11, },
/*166*/ {10, 5, 2, 5, 2, 4, 11, 7, 6, 2, 0, 4, },
/*167*/ {8, 4, 7, 11, 2, 3, 6, 10, 5, },
/*168*/ {7, 3, 6, 3, 2, 6, 5, 9, 4, },
/*169*/ {8, 7, 0, 7, 0, 6, 9, 5, 4, 0, 2, 6, },
/*170*/ {0, 3, 4, 3, 4, 7, 1, 2, 5, 2, 5, 6, },
/*171*/ {6, 2, 5, 2, 1, 5, 4, 8, 7, },
/*172*/ {9, 4, 1, 4, 1, 7, 10, 6, 5, 1, 3, 7, },
/*173*/ {0, 1, 9, 4, 7, 8, 5, 6, 10, },
/*174*/ {4, 0, 7, 0, 3, 7, 6, 10, 5, },
/*175*/ {4, 8, 7, 6, 10, 5, },
/*176*/ {5, 6, 9, 6, 9, 11, 9, 8, 11, },
/*177*/ {9, 5, 6, 9, 11, 6, 9, 11, 0, 11, 3, 0, },
/*178*/ {0, 1, 5, 0, 5, 11, 0, 8, 11, 6, 5, 11, },
/*179*/ {11, 6, 3, 6, 3, 5, 3, 1, 5, },
/*180*/ {2, 1, 11, 1, 11, 9, 6, 5, 10, 11, 8, 9, },
/*181*/ {6, 5, 10, 2, 3, 11, 1, 0, 9, },
/*182*/ {11, 8, 2, 8, 0, 2, 10, 5, 6, },
/*183*/ {10, 5, 6, 11, 3, 2, },
/*184*/ {3, 2, 6, 3, 6, 9, 3, 8, 9, 5, 6, 9, },
/*185*/ {5, 9, 6, 9, 6, 0, 6, 2, 0, },
/*186*/ {1, 5, 2, 5, 6, 2, 3, 8, 0, },
/*187*/ {1, 5, 2, 5, 6, 2, },
/*188*/ {1, 3, 9, 3, 8, 9, 5, 6, 10, },
/*189*/ {1, 0, 9, 5, 6, 10, },
/*190*/ {0, 3, 8, 5, 6, 10, },
/*191*/ {10, 5, 6, },
/*192*/ {5, 7, 10, 7, 11, 10, },
/*193*/ {11, 10, 7, 10, 5, 7, 8, 0, 3, },
/*194*/ {5, 7, 10, 7, 11, 10, 1, 0, 9, },
/*195*/ {8, 7, 9, 7, 9, 5, 3, 11, 1, 11, 1, 10, },
/*196*/ {2, 11, 1, 11, 1, 7, 1, 5, 7, },
/*197*/ {8, 0, 7, 0, 7, 1, 11, 2, 3, 7, 5, 1, },
/*198*/ {9, 5, 7, 9, 7, 2, 9, 0, 2, 11, 7, 2, },
/*199*/ {7, 5, 8, 5, 9, 8, 3, 2, 11, },
/*200*/ {10, 2, 5, 2, 5, 3, 5, 7, 3, },
/*201*/ {8, 7, 5, 8, 5, 2, 8, 0, 2, 10, 5, 2, },
/*202*/ {10, 2, 5, 2, 5, 3, 9, 0, 1, 5, 7, 3, },
/*203*/ {9, 8, 5, 8, 7, 5, 10, 2, 1, },
/*204*/ {7, 3, 1, 7, 1, 5, },
/*205*/ {8, 0, 7, 0, 7, 1, 7, 5, 1, },
/*206*/ {0, 9, 3, 9, 3, 5, 3, 7, 5, },
/*207*/ {7, 5, 8, 5, 9, 8, },
/*208*/ {4, 5, 8, 5, 8, 10, 8, 11, 10, },
/*209*/ {3, 0, 4, 3, 4, 10, 3, 11, 10, 5, 4, 10, },
/*210*/ {4, 5, 8, 5, 8, 10, 0, 1, 9, 8, 11, 10, },
/*211*/ {10, 11, 1, 11, 3, 1, 9, 4, 5, },
/*212*/ {4, 5, 1, 4, 1, 11, 4, 8, 11, 2, 1, 11, },
/*213*/ {0, 4, 1, 4, 5, 1, 2, 11, 3, },
/*214*/ {0, 2, 8, 2, 11, 8, 4, 5, 9, },
/*215*/ {4, 5, 9, 3, 2, 11, },
/*216*/ {8, 3, 2, 8, 10, 2, 8, 10, 4, 10, 5, 4, },
/*217*/ {10, 5, 2, 5, 2, 4, 2, 0, 4, },
/*218*/ {8, 3, 0, 9, 5, 4, 1, 10, 2, },
/*219*/ {9, 4, 5, 10, 2, 1, },
/*220*/ {4, 8, 5, 8, 5, 3, 5, 1, 3, },
/*221*/ {5, 1, 4, 1, 0, 4, },
/*222*/ {0, 3, 8, 4, 5, 9, },
/*223*/ {4, 5, 9, },
/*224*/ {7, 4, 11, 4, 11, 9, 11, 10, 9, },
/*225*/ {0, 3, 9, 3, 9, 11, 4, 7, 8, 9, 10, 11, },
/*226*/ {7, 4, 0, 7, 0, 10, 7, 11, 10, 1, 0, 10, },
/*227*/ {3, 1, 11, 1, 10, 11, 7, 4, 8, },
/*228*/ {4, 7, 11, 4, 2, 11, 4, 2, 9, 2, 1, 9, },
/*229*/ {4, 7, 8, 0, 1, 9, 3, 2, 11, },
/*230*/ {7, 11, 4, 11, 4, 2, 4, 0, 2, },
/*231*/ {3, 2, 11, 7, 4, 8, },
/*232*/ {4, 7, 3, 4, 3, 10, 4, 9, 10, 2, 3, 10, },
/*233*/ {9, 10, 0, 10, 2, 0, 8, 7, 4, },
/*234*/ {3, 7, 0, 7, 4, 0, 1, 10, 2, },
/*235*/ {8, 7, 4, 1, 10, 2, },
/*236*/ {9, 4, 1, 4, 1, 7, 1, 3, 7, },
/*237*/ {8, 7, 4, 9, 1, 0, },
/*238*/ {3, 7, 0, 7, 4, 0, },
/*239*/ {8, 7, 4, },
/*240*/ {8, 9, 10, 8, 10, 11, },
/*241*/ {0, 3, 9, 3, 9, 11, 9, 10, 11, },
/*242*/ {1, 0, 10, 0, 10, 8, 10, 11, 8, },
/*243*/ {3, 1, 11, 1, 10, 11, },
/*244*/ {2, 1, 11, 1, 11, 9, 11, 8, 9, },
/*245*/ {0, 9, 1, 2, 11, 3, },
/*246*/ {0, 2, 8, 2, 11, 8, },
/*247*/ {3, 2, 11, },
/*248*/ {3, 2, 8, 2, 8, 10, 8, 9, 10, },
/*249*/ {2, 0, 10, 0, 9, 10, },
/*250*/ {1, 10, 2, 3, 8, 0, },
/*251*/ {2, 1, 10, },
/*252*/ {1, 3, 9, 3, 8, 9, },
/*253*/ {9, 1, 0, },
/*254*/ {0, 3, 8, },
/*255*/ {},
};

};